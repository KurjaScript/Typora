#### 1.为什么要实现父子组件通信

在开发中，往往一些数据需要从上层传递到下层。比如在一个页面中，我们从服务器请求到了很多数据，其中一部分数据并非是整个页面的大组件来展示，而是需要下面的子组件来展示。这个时候，并不会让子组件再次发送一个网络请求，而是直接让大组件(父组件)将数据传递给小组件(子组件)。

#### 2. 如何进行父子组件通信？

- 父组件通过**props**向子组件传递数据
- 子组件通过事件向父组件发送信息

![image-20220118111001023](C:\Users\GunKing\AppData\Roaming\Typora\typora-user-images\image-20220118111001023.png)

#### 3. 父传子——props的基本用法

- 首先,给组件传静态的值很容易，如Vue官网的例子

```html
<blog-post title="My journey with Vue"></blog-post>
```

- 但我们一般需要给子组件传动态的值。所以需要**v-bind**绑定 ，如Vue官网的例子

```html
<!-- 动态赋予一个变量的值 -->
<blog-post :title="post.title"></blog-post>

<!-- 动态赋予一个复杂表达式的值 -->
<blog-post :title="post.title + 'by' + post.author.name">
```

- 要接受父组件的传值，子组件实例的作用域必须是孤立的；子组件显示地用**props**选项来声明它预期得到地数据，如：

```js
//某个子组件
export default{
	props: {
		title:{
			type: String,
			default: 'hello world!'
		}
	}
}
```

以上就是**单向数据流**地一般表现了：父级prop的更新会向下流动到子组件中，但是反过来则不行。

#### 4. 子组件向父组件传值

- 在Vue中，父子组件的关系可以总结为：prop向下传递，事件向上传递。父组件通过**prop**给子组件下发数据，**子组件通过事件给父组件发送信息**。
- 每个Vue实例都实现了事件接口：**使用$on(eventName)监听事件**；**使用$emit(eventName, optionalPayload)触发事件**。另外，父组件可以在使用子组件的地方直接用v-on来监听子组件触发的事件。

**举例说明**

- 父组件在组件上定义了一个自定义事件**childFn**，事件名为**parentFn**用于接受子组件传来的message值。

```vue
<!-- 父组件 -->
<template>
    <div class="test">
      <test-com @childFn="parentFn"></test-com>
      <br/> 
      子组件传来的值 : {{message}}
    </div>
</template>

<script>
export default {
    // ...
    data() {
        return {
             message: ''
        }
    },
    methods: {
       parentFn(payload) {
        this.message = payload;
      }
    }
}
</script>
```

- 子组件是一个button按钮，并为其添加了一个click事件，当点击的时候使用$emit()触发事件，把message传给父组件。

```vue
<!-- 子组件 -->
<template> 
<div class="testCom">
    <input type="text" v-model="message" />
    <button @click="click">Send</button>
</div>
</template>
<script>
export default {
    // ...
    data() {
        return {
          // 默认
          message: '我是来自子组件的消息'
        }
    },
    methods: {
      click() {
            this.$emit('childFn', this.message);
        }
    }    
}
</script>
```

- 这样，我们就实现了子组件向父组件传值了

![image-20220118135550656](C:\Users\GunKing\AppData\Roaming\Typora\typora-user-images\image-20220118135550656.png)

#### 5. 小结

以上这些就够用了，一开始会觉得绕，多实现几次就理解了。