### 进程与线程的联系与区别

当我们启动某个程序时，操作系统会分配一块内存用来存放代码、数据和一个执行任务的主线程，这样一个运行环境叫**进程**。

线程依附于进程，在进程中使用多个线程并行处理能提升运算效率。进程将任务分为多个细小的任务，再创建多个线程，在这些线程中并行执行。

#### 进程与线程的关系特点

- 进程与进程之间完全隔离，互不干扰，一个进程崩溃不会影响其他进程，避免一个进程出错影响整个程序；

- 进程与进程之间需要传递某些数据的话，就需要通过**进程通信管道IPC**来传递；

- 一个进程中可以并发多个线程，每个线程并行执行不同的任务；

- 一个进程中的任意一个线程执行出错，会导致这个进程崩溃；

- 同一进程下的线程之间可以直接通信和共享数据；

- 当一个进程关闭之后，操作系统会回收该进程的内存空间。

#### Chrome 打开一个页面有多少进程？分别是哪些

一个浏览器从关闭状态到启动，然后新打开一个页面至少需要四个进程：一个**浏览器进程**、一个**GPU进程**、一个**网络进程**、一个**渲染进程**。

#### 多标签之间怎么通信

没有办法直接通信，需要有一个缓冲区进行消息的接收和转发，比如

- `localStorage`：在一个标签页监听 `localStorage` 的变化，然后当另一个标签页修改时，可以通过监听获取新数据；

- `WebSocket`：因为`websocket`可以实现实时服务器推送，所以**服务器就可以来当这个中介者**。标签页通过向服务器发送数据，然后服务器再向其他标签推送转发；

- `postMessage`：

  ```js
  // 发送方
  window.parent().postMessage('发送的数据', 'http://接收地址')
  // 接收方
  window.addEventListener('message', (e) => {let data = e.data})
  ```

#### 疑问：

1. `ajax` 请求只是用到 `http` 请求线程吗，不涉及网络进程吗？

   答：`ajax` 是直接通过网络进程。 

2. 事件触发线程和异步线程、计时器线程之间是什么关系？

   答：它们都是宏任务，放在他们各自优先级的宏任务队列里，渲染进程的主线程会按照优先级去拿。

