### 1. 浏览器之于应用的地位

浏览器自诞生之日起，其地位就一直很重要，而且这种重要性还在不断加强。

**浏览器发展历程中的三大进化路线：**

**第一是应用程序 Web 化。**随着云计算的普及和 HTML5 技术的快速发展，越来越多的应用转向了浏览器 / 服务器（B/S）架构，这种改变让浏览器的重要性与日俱增，视频、音频、游戏几大核心场景也都在往 Web 的使用场景切换。

**第二是 Web 应用移动化。**对于移动设备应用，Web 天生具有开放的基因，虽然在技术层面还有问题尚待解决（比如，渲染流程过于复杂且性能不及原生应用、离线时用户无法使用、无法接收消息推送、移动端没有一级入口），**但 Google 推出了 PWA 方案来整合 Web 和本地程序各自的优势。**顺便说一句，PWA 也是我个人非常期待的方案。

**第三是 Web 操作系统化。**Web 操作系统有两层含义：**一是利用 Web 技术构建一个纯粹的操作系统，如 ChromeOS**；**二是浏览器的底层结构往操作系统架构方向发展**，在整个架构演化的大背景下会牵涉诸多改变，下面列举一些我认为相对重要的改变。

- Chrome 朝着 SOA 的方向演化，未来很多模块都会以服务的形式提供给上层应用使用；
- 在浏览器中引入多种编程语言的支持，比如新支持的 WebAssembly；
- 简化渲染流程，使得渲染过程更加直接高效；
- 加大对系统设备特性的支持；
- 提供对复杂 Web 项目开发的支持。

也就是说，浏览器已经逐步演化成可系统之上的“操作系统”。

### 2. 为什么需要学习浏览器工作原理？

#### 2.1 准确评估 Web 开发项目的可行性

#### 2.2 能站在用户体验角度来考虑页面性能

- 当用户请求一个网站时，如果在 1 秒内看不到关键内容，用户会产生任务被中断的感觉。
- 当用户点击某些按钮时，如果 100ms 内无法响应，用户会感受到延迟。
- 如果 Web 中的动画没有达到 60fps，用户会感受到动画的卡顿。

如果要开发出流畅的页面，或者诊断 Web 页面中的性能问题，那就需要了解 URL 是怎么变成页面的。

理解了从输入 URL 到渲染出页面的过程，就能全视野快速定位项目中不合理的地方。比如，**首屏的显示就涉及了 DNS、HTTP、DOM 解析、CSS 阻塞、JavaScript 阻塞等技术因素，其中一项没处理好就可能导致整个页面的延时。**

#### 2.3 在快节奏的技术迭代中把握本质

**Node.js 是前端发展的一个核心推动力。**Node.js 是基于 Chrome 的 JavaScript 引擎 V8 来实现的，它的特点是可以脱离浏览器环境来执行 JavaScript，于是可以使用 JavaScript 写服务器程序了。

回溯前端技术是如何针对这些核心诉求演化的：

**首先是脚本执行速度问题。**针对 JavaScript 设计缺陷和执行效率的问题，可以从以下两个途径解决：

- 不断修订和更新语言本身，这样你就应该知道 ES6、ES7、ES8，或者 TypeScript 出现的必要性。这种修订对目前生态环境的改动是最小的，所以推行起来会比较容易。
- 颠覆性地使用新的语言，这就是 WebAssembly 出现的原因。WebAssembly 需要经过编译器编译，所以体积小、执行速度快，使用它能大幅提升语言的执行效率，但是语言本身的完善，和生态的构建都是需要花很长时间来打造的。

**其次是前端模块化开发。**模块化开发的需求应运出 WebComponent 标准，我们熟悉的 React 和 Vue 都在渐进地适应 WebComponent 标准，同时各种前端框架的最佳实践也会反过来影响 WebComponents 标准的制定。

如果理解了浏览器工作原理，那么你会对 WebComponent 中涉及的 Shadow DOM、HTML Templates 等技术有更深刻的理解。

**最后是渲染效率问题。**如果理解浏览器的渲染流程，我们就会知道目前页面的渲染依然存在很大缺陷，然后就清楚如何避开这些问题，从而开发出更高效的 Web 应用。与此同时，Chrome 团队也在着手改善这些缺陷，比如正在开发的下一代布局方案 LayoutNG，还有渲染瘦身方案 Slim Paint，其目的都是让渲染变得更加简单和高效。

